# PRODUCTION-READY EXAMPLE WITH ADVANCED FEATURES
# Demonstrates file sizing, hourly partitioning, and advanced Bronze settings.

environment: prod
domain: crm

system: salesforce
entity: accounts

bronze:
  enabled: true
  source_type: api
  connection_name: SALESFORCE_TOKEN
  source_query: /services/data/v58.0/query
  partition_column: hour_bucket
  options:
    load_pattern: append_log
    api:
      base_url: https://api.salesforce.com
      method: GET
      params:
        q: SELECT Id, Name, Industry, CreatedDate FROM Account WHERE IsDeleted = false
      pagination:
        type: cursor
        next_token_path: nextRecordsUrl
        records_path: records
    max_rows_per_file: 1000000
    max_file_size_mb: 256
    parallel_workers: 4
    cleanup_on_failure: true
    local_output_dir: ./output/bronze

silver:
  enabled: true

  entity_kind: event                    # API produces row-level events
  input_mode: append_log
  delete_mode: ignore
  schema_mode: allow_new_columns

  natural_keys:
    - Id

  event_ts_column: CreatedDate
  change_ts_column: CreatedDate

  attributes:
    - Name
    - Industry

  partition_by:
    - CreatedDate_dt
