environment: dev
domain: claims

datasets:
  - name: claim_header
    system: claims
    entity: claim_header

    # Intent-centric bronze section for semantic owners
    # Step 1 (Understanding what you are onboarding):
    #   - Spell out the logical entity name and the system it belongs to.
    #   - The framework will infer folders/partitions from these values.
    #   - Avoid worrying about folder names or metadata paths; Bronze will derive them.
    bronze:
      enabled: true
      source_type: file
      path_pattern: ./sampledata/source_samples/pattern1_full_events/system=claims/table=claim_header/pattern=pattern1_full_events/dt=2025-11-13/
      partition_column: run_date
      owner_team: claims-platform
      owner_contact: claims-team@example.com
      options:
        format: parquet
        load_pattern: full
        max_file_size_mb: 256
        max_rows_per_file: 500000

    # Step 4 (Mapping Source → Bronze) – describe format, keys, partitions in plain language.
    silver:
      enabled: true
      entity_kind: event   # plain-English answer: this dataset captures events
      history_mode: scd2   # only for state-like entities; defaults to scd2 when needed
      input_mode: append_log

      natural_keys:
        - claim_id
      event_ts_column: event_ts
      attributes:
        - status
        - amount

      # Bronze traceability metadata (Step 6: Declare readiness)
      # The pipeline records these columns automatically; you can add your own annotations.
      partition_by:
        - event_ts_dt

  - name: claim_line
    system: claims
    entity: claim_line
    bronze:
      enabled: true
      source_type: file
      path_pattern: ./sampledata/source_samples/pattern2_cdc_events/system=claims/table=claim_line/pattern=pattern2_cdc_events/dt=2025-11-13/
      partition_column: run_date
      options:
        format: csv
        load_pattern: cdc

    silver:
      enabled: true
      entity_kind: event
      input_mode: append_log
      natural_keys:
        - claim_id
        - line_id
      event_ts_column: updated_at
      attributes:
        - status
        - amount
