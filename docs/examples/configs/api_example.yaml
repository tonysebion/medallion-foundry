# BASIC API EXTRACTION EXAMPLE
# This demonstrates extracting data from a REST API endpoint while keeping intent-focused knobs.

environment: test
domain: support

system: example_product
entity: tickets

bronze:
  enabled: true
  source_type: api
  connection_name: EXAMPLE_API_TOKEN            # bearer token comes from this env var
  source_query: /v1/tickets                     # endpoint path
  partition_column: load_date
  options:
    load_pattern: cdc                           # upstream API emits deltas
    api:
      base_url: https://api.example.com
      method: GET
      params:
        page_size: 100
      pagination:
        type: none
    local_output_dir: ./output                  # keep sample output on the local filesystem

silver:
  enabled: true

  entity_kind: event            # support tickets arrive as events
  input_mode: append_log        # Bronze only appends new deltas
  delete_mode: ignore           # tickets are closed via status changes
  schema_mode: allow_new_columns

  natural_keys:
    - ticket_id

  event_ts_column: updated_at
  change_ts_column: updated_at

  attributes:
    - status
    - severity
    - owner_id

  partition_by:
    - updated_at_dt
