# BASIC API EXTRACTION EXAMPLE
# This demonstrates extracting data from a REST API endpoint

platform:
  bronze:
    # Storage backend: "s3", "azure", or "local"
    # Defaults to "s3" if not specified (for backward compatibility)
    storage_backend: "s3"

    s3_bucket: "analytics-bronze"
    s3_prefix: "bronze"
    partitioning:
      use_dt_partition: true
    output_defaults:
      allow_csv: true
      allow_parquet: true
      parquet_compression: "snappy"

  s3_connection:
    endpoint_url_env: "BRONZE_S3_ENDPOINT"
    access_key_env: "BRONZE_S3_ACCESS_KEY"
    secret_key_env: "BRONZE_S3_SECRET_KEY"

source:
  type: "api"
  system: "example_product"  # policies use system/table paths
  table: "tickets"

  api:
    base_url: "https://api.example.com"
    endpoint: "/v1/tickets"
    method: "GET"

    auth_type: "bearer"  # swap to api_key/basic if needed
    auth_token_env: "EXAMPLE_API_TOKEN"

    params:
      page_size: 100

    pagination:
      type: "none"  # starts without paging; uncomment offsets/pages below as needed
    # pagination:
    #   type: "page"
    #   page_size: 100
    #   page_param: "page"

  run:
    max_rows_per_file: 500000  # large chunk size for sampling
    write_csv: true  # keep CSV for debugging
    write_parquet: true  # analytics default
    s3_enabled: false
    local_output_dir: "./output"
