# DATABASE EXTRACTION EXAMPLE
# This demonstrates extracting data from a SQL database

platform:
  bronze:
    # Storage backend: "s3", "azure", or "local"
    storage_backend: "s3"

    s3_bucket: "analytics-bronze"
    s3_prefix: "bronze"
    partitioning:
      use_dt_partition: true
    output_defaults:
      allow_csv: true
      allow_parquet: true
      parquet_compression: "snappy"

  s3_connection:
    endpoint_url_env: "BRONZE_S3_ENDPOINT"
    access_key_env: "BRONZE_S3_ACCESS_KEY"
    secret_key_env: "BRONZE_S3_SECRET_KEY"

source:
  type: "db"
  system: "claims_dw"
  table: "claims_header"

  db:
    conn_str_env: "CLAIMS_DB_CONN_STR"

    base_query: |
      SELECT TOP 100
          ClaimID,
          MemberID,
          ServiceDate,
          Amount
      FROM dbo.ClaimsHeader
    # Add incremental clause or WHERE filters as needed


  run:
    max_rows_per_file: 500000
    write_csv: true
    write_parquet: true
    s3_enabled: false
    local_output_dir: "./output"
